<!DOCTYPE html>
<HTML>
<HEAD>
   <meta charset="UTF-8">
   <TITLE>BB Lab, Keitai Memory dial</TITLE>
</HEAD>
<BODY BACKGROUND="bcg_280.gif">
<A NAME="TOP_TOP"></A><FONT SIZE=-1>このページはNetscape
Navigator 2.0以降及びMicrosoft Internet Explorer 3.0以降で正常に見られます。</FONT>
<BR><FONT SIZE=-2>Solly,Japanese only</FONT>
<BR>
<HR>
<CENTER><BLINK><FONT COLOR="#3366FF"><FONT SIZE=-1>★ ＢＢ研究所 ★</FONT></FONT></BLINK></CENTER>
<CENTER><FONT COLOR="#3366FF"><FONT SIZE=+2>携帯電話メモリダイヤルアクセス －ハードウェア編－ </FONT></FONT></CENTER>
<P>
<HR>
<H3><FONT COLOR="#3366FF">はじめに</FONT></H3>
　最近携帯電話のメモリダイヤルを管理するツールが各社から発売され、結構売れているようです。<BR>
やはり数千万台も普及している携帯電話の電話帳を管理するニーズがあるということでしょう。今後は、表計算ソフトや、住所録等のソフトでは、携帯電話のメモリダイヤルの管理は必須条件となってくるかも知れません。<BR>
　ということで、今回は携帯電話のメモリダイヤルについて取り上げました。<BR>
　最終的には今度新規（実に１年ぶり！）に作成した、<A HREF="http://www2s.biglobe.ne.jp/~img/download_free.htm#BBK">【ＢＢ携帯電話メモリダイヤルアクセスライブラリ（ＢＢＫライブラリ）】</A>を、みなさんに使っていただこうと企画です。このライブラリはフリーです。是非使ってみて下さい。<BR>
　解説は大きく２つのパートに別けました。先ずは、【ハードウェア編】。ここではケーブル接続について解説します。次に【ソフト設定編】です。ここでは、ＶＣ＋＋を使い、シリアルポートを通じてアクセスする方法を解説します。また、私の作ったBBKライブラリによるアクセス法についても解説します。<BR>
尚、ここに載っている情報は、<A HREF="http://docomo-web.nttdocomo.co.jp/ntt_docomo/ntt_car/cindex.html">NTT DoCoMo</A>のホームページを元にしています。もし、電子回路や通信の知識があり、ヒマがたっぷりある人ならば、直接NTT DoCoMoのホームページをご覧ください。<BR><BR>
それでは、ハードウェア編の説明をします。<BR>
<HR>
<P>


<H3><FONT COLOR="#3366FF">PC側シリアルポート信号線</FONT></H3>
携帯電話との通信インタフェースとして、ＰＣ側はシリアルポートを使用します。<BR>
携帯電話の、メモリダイヤル用シリアル信号は、無手順、調歩式をとっています。PC側のシリアルポートがこの方式で通信できるように、PC側の端子は以下のようにします。<BR>
※９ピンを前提にしています。<BR>
※説明のないピンはNC(接続せず)<BR>
<table border="1">
    <tr><td>信号名</td><td>ピン番号</td><td>説明</td></tr>
    <tr><td>TXD</td><td>3</td><td>送信（携帯側のシリアルINへ）</td></tr>
    <tr><td>RXD</td><td>2</td><td>受信（携帯側のシリアルOUTへ）</td></tr>
    <tr><td>RTS</td><td>7</td><td>ハンドシェーク用（使わないので、CTSとショート）</td></tr>
    <tr><td>CTS</td><td>8</td><td>ハンドシェーク用（使わないので、RTSとショート）</td></tr>
    <tr><td>G</td><td>5</td><td>グランド</td></tr>
</table>
<BR>
<HR>
<H3><FONT COLOR="#3366FF">携帯側シリアルポート信号線</FONT></H3>
携帯電話側は、電話の底面にあるコネクタを使用します。通常このコネクタ単品は発売されていませんが、秋葉原などの電気街で、ジャンク品を探せば入手できます。メーカによって若干形状が異なることがあるようですが、松下用のものを使用すれば、ほぼ全ての携帯電話に接続できるようです。<BR>
PC側と同様に携帯側の信号で、メモリダイヤル用シリアルに使用するものを以下に示します。<BR><BR>

<BR>
<table border="1">
    <tr><td>信号名</td><td>ピン番号</td><td>説明</td></tr>
    <tr><td>シリアルＩＮ</td><td>6</td><td>受信（携帯側のTXDへ）</td></tr>
    <tr><td>シリアルOUT</td><td>7</td><td>送信（携帯側のRXDへ）</td></tr>
    <tr><td>携帯機操作部制御信号１</td><td>12</td><td>通信中はGNDに落とす</td></tr>
    <tr><td>G</td><td>1,3,9</td><td>グランド</td></tr>
</table>
<BR>
<BR>

<FONT COLOR=DARKRED>【改訂：99/03/02,11,12,21】コネクタ収集情報</FONT><BR>
ユーザからの報告で以下の店で入手できるようです。<BR>
<UL>
<LI><A HREF="http://www.sengoku.co.jp/">千石電商</A>･･･店内の入口付近に売ってました</A>
<LI>SHINKO DENKI?（うろ覚え）･･･千石電商の隣のお店。安かったです（でも在庫が少なそう）
<LI><A HREF="http://home.interlink.or.jp/~maple/conoder.htm">メイプル</A>･･･通販です
<LI>西川電子部品･･･秋葉原ラジオデパートの１Ｆ入口です（03-3251-6715）
<LI><A HREF="http://www.kyohritsu.com/DIGIT/index.html">デジット</A>･･･大阪日本橋４丁目にあるそうです。ジャンク品です。※P208には接続できないとのことです(2000/03/05修正）。
</UL>
また、ＪＲの駅のＫＩＯＳＫで、ＴＯＰＬＡＮＤの「電話の電池」というものが売ってました。<BR>
要は携帯電話の電池が切れた時に使用する使い捨ての電池です。コネクタ経由で電源を供給するので、
このコネクタを流用することができます。<BR>
値段はなんと５８０円(安)！<BR>
ピンがあるのが、1P,3P,6P,8Pのみですので、GNDに1Pだけを使用し、3Pと8Pを抜いて、
7Pと12Pに刺せばメモリダイヤル用のコネクタに流用できます。<BR>
但し、本来別の用途に使用するものを、無理矢理流用するので、工作に工夫が必要です。<BR>
【補足】<BR>
3PはGNDですがシリアル用ではないのでNCでもかまいません。<BR>
また、9Pは1Pと携帯内部でつながっていることに期待してNCとしています。<BR>
もしかしたら、NGになる携帯電話もあるかもしれません<BR>


<HR>
<P>

<H3><FONT COLOR="#3366FF">携帯電話コネクタピンアサイン</FONT></H3><BR>
<FONT COLOR=DARKRED>【改訂:99/02/16】</FONT><BR>
<CENTER><IMG SRC="img/conector.gif"></CENTER><BR>
詳細は、NTT-DoCoMoの<A HREF="http://docomo-web.nttdocomo.co.jp/ntt_docomo/ntt_car/html/2_3_1_2.html">2.3.1.2項</A>を参照して下さい。<BR>
<HR>
<P>


<H3><FONT COLOR="#3366FF">ＰＣと携帯電話の接続</FONT></H3>
　私は当初、PC側と携帯電話の信号線を直結していましたが、このときは全然動きませんでした。ＰＣ側はＲＳ－２３２Ｃ規格に沿ってますが、携帯電話側は、C-MOSの出力そのままになっているためです。信号レベルが違うことは知っていて、抵抗をかませば何とかなるだろうと思ってたのですが、なんともなりませんでした。ということで、レベル変換ICを使用します。<BR>
　適当なものを使ってかまいませんが、ここでは、アナログデバイセズの<A HREF="http://products.analog.com/products/info.asp?product=ADM222">ADM232A</A>を使用します。これは<A HREF="http://202.220.160.150:80/AKIZUKI/">（有）秋月通商</A>から安い値段で入手できます。<BR>
<FONT COLOR=DARKRED>【改訂:99/02/16】</FONT><BR>
　また、ICを使用する場合、IC用の電源が必要になります。これをPCから供給することにする場合は、（余計なコネクタはつけたくないので）乱暴ですがRTS-CTS端子から電源をとり、<FONT COLOR=DARKRED>ダイオードを通じてダイレクトにICの電源とします</FONT><FONT SIZE=-1>（当初は、５Vの３端子レギュレータを使用していたのですが(v0.02迄）、これだと一部の携帯電話でデータ化けをおこしてしまいました。原因を探ってみたら、ICの電源電圧が実測で２Ｖ台でした。レギュレータを通さずに直結したら、４Ｖ台になり、データ化けも解消できました）</FONT>。<BR>
　以上のことを考慮すると、以下のような接続になります。<BR><BR>
<FONT COLOR=DARKRED>【改訂:99/02/26】</FONT><BR>
<FONT COLOR=DARKBLUE>●重要●<BR>
携帯側の6Pと7Pが逆でした。全くもって申し訳なし。<BR></FONT>
<CENTER><IMG SRC="img/p2k.gif" WIDTH=504 HEIGHT=347><BR>接続図</CENTER>

<BR>
<CENTER><IMG SRC="img/p2k_smpl.jpg" WIDTH=180 HEIGHT=192><BR>作成したケーブル</CENTER>
<BR>

 <FONT COLOR=DARKRED>【改訂:99/01/04】<BR>
ケータイ・エディを使用する場合は、赤字で示す「携帯機操作部制御信号１」を接続する必要があります。<BR>
ただし、ケータイ・エディ付属のケーブルと異なり、データ転送後は必ず一旦、コネクタを携帯電話から外す必要があります（さもないと、次の転送を受け付けません）。<BR>
また、「携帯機操作部制御信号１」を接続するとBBKライブラリv0.001では一部動作しない機種があります（松下系）。<BR>
<BR>
その他のメモリダイヤルツールについては、試していないので不明です。<BR>
</FONT>
※v0.02以降の「BBKライブラリ」では、必ず「携帯機操作部制御信号１」を接続する必要があります。<BR>
 <FONT COLOR=DARKRED>【改訂:99/12/10】</FONT><BR>
上記回路図より、簡単で安そうな回路図をAKIYAMA氏より教えていただいたのでお知らせします<BR>
<A HREF="http://wwwf.mvi.co.jp/Spot/cable_notice.html">（株）メディアヴィジョン　福岡オフィス　非公式サイト http://wwwf.mvi.co.jp/Spot/cable_notice.html</A><BR>

<BR><BR>
<HR>
<H3><FONT COLOR="#3366FF">追加情報：ＣｄｍａＯｎｅとの接続</FONT></H3>
<BR>
 <FONT COLOR=DARKRED>【改訂:2000/11/25】</FONT><BR>
takecan氏から、CdmaOneとの接続について情報を寄せていただきましたので紹介します。<BR>
上記の回路のコネクタ部の接続を以下のように接続すればよいとのことです。<BR>
この情報の内容については未検証のため、頂いたメールをそのまま掲載致します。<BR><BR>
<TABLE  BORDER=1 cellspacing="0" bgcolor="#FFFFFF" >
<TR><TD>
<FONT SIZE=-1>
(2000/11/12)<BR><BR>
CdmaOneのコネクタ情報も掲載して下さい。 <BR>
<IMG SRC="img/cdma-one.jpg"><BR>
参考にしたのは、充電器と「ケータイマスター２００１ For CdmaOne」付属のケーブルです。<BR>
９ピンコネクタ内部に回路がありました。 <BR>
Rx、Tx回路にトランジスタが各１、電源は７・８ピンから流用しています。 <BR>
<BR>
後は抵抗５個、ダイオード替わりのTrが２個の構成です。 <BR>
<BR>
この部分は、「ハードウエア編」にあるものと同じ機能でしょう。 <BR>
<BR>
ｂｙ　takecan <BR>
  <BR>
<BR>
</TD></TR>
</TABLE>
<BR>
【補足】<BR>
<BR>
・上記「９ピンコネクタ内部に回路がありました。」とは、<BR>
　「PC側(9P)シリアルコネクタのケース内に回路が組まれていた」という意味です。<BR>
<BR>
・上記中「Rx、Tx回路にトランジスタが･･･」という記述の<BR>
　Tx,Rxはそれぞれ送信，受信の意味です。<BR>
　多分、元回路の携帯側コネクタ７ピン，６ピンに相当すると思います。<BR>
　（もし動かないようなら逆にしてみてください）<BR>
<BR>
・上記「･･･電源は７・８ピンから流用しています。」という記述の「７・８ピン」は、<BR>
　ＰＣ側コネクタの７ピン，８ピンという意味です。<BR>
<BR>
<BR>
 <FONT COLOR=DARKRED>【改訂:2000/11/31】</FONT><BR>
takecan氏より、更に修正情報を頂きました。<BR>
そのまま掲載させていただきます。<BR>
<TABLE  BORDER=1 cellspacing="0" bgcolor="#FFFFFF" >
<TR><TD>
<FONT SIZE=-1>
(2000/11/28)<BR><BR>
こんにちわ。<BR>
<BR>
接続ピンの誤りが昨日判明しましたので、取り急ぎお知らせします。<BR>
<BR>
６ピン（ＡＮＴ側から）ＧＮＤは、８番の間違いでした。<BR>
（ピンを引き抜いて、数えなおし判明しました。）<BR>
<BR>
実害はありません（機能障害は認められませんでした）が、接続しないか、<BR>
８番ピンへ接続をしてください。<BR>
<BR>
このＧＮＤは、外部電源接続を知らせるためのもので、接続時に照明を<BR>
ＯＮにする機能等に関係しています。<BR>
<BR>
はんだ付けの際、いくつかの不具合を経験しましたので参考までに．．<BR>
１．ピンは全て引き抜き、はんだ付けのあと（収縮チューブでカバーして）コネクタに戻す．<BR>
２．はんだが流れ過ぎないように、少量のはんだ使用に留める。<BR>
<BR>
せっかくＨＰへ記載して頂いた直後で、すみませんでした。<BR>
</TD></TR>
</TABLE>
<BR>
 <FONT COLOR=DARKRED>【改訂:2000/12/22】</FONT><BR>
CdmaOneのコネクタ情報を入手しましたので掲載致します。<BR>
<table border="1" cellspacing="0" bgcolor="#FFFFFF" >
    <tr><td>ピン番号</td><td>信号名</td><td>説明</td></tr>
	<tr><td>　１</td><td>接地</td><td>-</td></tr>
	<tr><td>　２</td><td>送信音声信号</td><td>端末等からアナログ音声信号を受信するための端子</td></tr>
	<tr><td>　３</td><td>ＣＣ</td><td>移動機が接続された事を端末等に通知するための端子</td></tr>
	<tr><td>　４</td><td>音声受信信号</td><td>端末等にアナログ音声信号を送信するための端子</td></tr>
	<tr><td>　５</td><td>ＣＦ</td><td>データ通信時にＰＰＰ再確立しなければならないことを端末等に知らせる端子</td></tr>
	<tr><td>　６</td><td>ＢＡ</td><td>データ通信時に上りデータを受信する。端子データは非同期（調歩）転送</td></tr>
	<tr><td>　７</td><td>ＣＢ</td><td>データ通信時に上りデータを制御する信号の送信端子</td></tr>
	<tr><td>　８</td><td>携帯操作部制御信号①</td><td>端末等から携帯操作部を制御する信号を受信するための端子</td></tr>
	<tr><td>　９</td><td>ＢＢ</td><td>データ通信時に下りデータを送信する。端子データは非同期（調歩）転送</td></tr>
	<tr><td>１０</td><td>携帯操作部制御信号②</td><td>端末等から携帯操作部を制御する信号を受信するための端子</td></tr>
	<tr><td>１１</td><td>上りシリアル信号</td><td>端末等から携帯機に送られてくるシリアル信号を受信するための端子</td></tr>
	<tr><td>１２</td><td>ＣＥ</td><td>データ通信時にＭＴｘの接続を検出するための端子</td></tr>
	<tr><td>１３</td><td>下りシリアル信号</td><td>携帯機から端末等にへシリアル信号を送信するための端子</td></tr>
	<tr><td>１４</td><td>ＣＤ</td><td>データ通信用のＭＴｘの接続を検出するための信号を受信するための端子</td></tr>
	<tr><td>１５</td><td>予約</td><td>-</td></tr>
	<tr><td>１６</td><td>予約</td><td>-</td></tr>
	<tr><td>１７</td><td>ＣＪ</td><td>データ通信時に下りデータを制御する信号を受信するための端子</td></tr>
	<tr><td>１８</td><td>接地</td><td>-</td></tr>
</table>
<BR>
<HR>
【改訂記録】<BR>
1998/08/31版：公開<BR>
1999/01/04版：回路図に「携帯機操作部制御信号１」を追加<BR>
1999/02/16版：回路図から３端子レギュレータ78L05削除,携帯電話コネクタピンアサイン追加<BR>
1999/02/26版：回路図誤記修正<BR>
1999/03/02版：コネクタ入手先追加<BR>
1999/03/11版：コネクタ入手先追加<BR>
1999/03/12版：コネクタ入手先追加<BR>
1999/03/21版：コネクタ入手先追加<BR>
1999/08/13版：コネクタ入手先追加<BR>
1999/12/10版：回路図リンク追加<BR>
2000/03/05版：コネクタ入手先修正<BR>
2000/11/25版：CdmaOne記事追加<BR>
2000/11/31版：CdmaOne修正記事追加<BR>
2000/12/22版：CdmaOne記事追加<BR>
<BR><A HREF="index.htm">【もどる】</A>
<HR><FONT SIZE=-1>Copyright (c) 1997-2000, BearBeetle, Allrights reserved.</FONT>
</BODY>
</HTML>
